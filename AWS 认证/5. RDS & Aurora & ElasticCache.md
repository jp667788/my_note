# RDS 

- 关系型数据库

## RDS 和 EC2 上部署 数据库服务

- 数据库的供应是完全自动化的
- 可以进行连续备份，可以恢复到特定的时间戳
- 可以使用监视面板来查看数据库的性能
- 为了提高读取性能, 您可以设置多AZ
- 有用于升级的维护窗口, 并且可以扩展公共功能
- 存储由EBS提供支持

## 存储自动缩放

- 在即将用完存储空间时，RDS 自动进行扩展
- 需要设置一个最大存储阈值

## 读副本

- 读副本可以帮助扩展读操作
- 它们可以位于同一可用性区域､跨可用性区域或跨区域
- 是主RDS数据库实例和两个Read Replica之间的异步复制
- 读取最终是一致的


## 多可用区 Multi AZ

- Multi AZ主要用于灾难恢复
- 应用程序写入主服务器时，应用程序获得的是 DNS 名称
- 如果主服务器出现问题, 将自动故障转移到备用数据库
- 备用数据库只用于备用，没人读到他
- 也可以将读副本设置为用于灾难恢复的多AZ
- 多可以区复制是同步的

###  从单AZ变为多AZ

- 这是一个零停机操作
- RDS将自动为您的主数据库拍摄快照
- 并且此快照将恢复到新的备用数据库中

##  RDS代理

- 可以为RDS部署完全托管的数据库代理
- 这将允许您和您的应用程序共享与数据库建立的数据库连接
- 这样就不是是让每个应用程序连接到RDS数据库实例,而是连接到代理, 代理将这些连接集中到RDS数据库实例的较少连接中
	- 这样可以减少数据库资源（例如CPU和RAM）的压力来提高数据库的效率, 并最大限度地减少打开的连接和数据库的超时

- RDS代理是完全无服务器的，它是自动扩展的，可跨可用区
	- 最大限度地减少故障转移时间,并将其减少多达66%
- 它用于对数据库强制执行IAM身份验证



# Aurora

- 它不是开源的, 但他们使它与Postgres和MySQL兼容
- 在RDS上获得了比MySQL高5倍的性能提升, 或者在RDS上获得了比Postgres高3倍的性能提升
- Aurora存储自动增长
- 最多可以有15个读取副本，并且复制过程将比MySQL更快


# 安全

- 可以加密RDS和Aurora数据库中的静态数据
	- 将使用KMS对主服务器和所有副本服务器进行加密
	- 如果没有加密master数据库（即主数据库）,则无法加密读取副本
	- 如果要加密现有的未加密数据库,则必须从该未加密数据库中获取数据库快照, 然后将该数据库快照还原为加密数据库
- 可以进行传输加密
	- 默认情况下, RDS和Aurora上的每个数据库都已准备好进行动态加密
- 数据库身份验证
	- 可以使用用户名和密码的经典组合
	- 也可以使用IAM角色连接到数据库
	- 使用安全组控制对数据库的网络访问
- 没有SSH访问权限

# ElasticCache

- 管理的Redis或Memcached, 这是缓存技术

## Redis  vs Memcached

- Redis
	- 自动故障转移
	- 多AZ
	- 读副本
	- 具有备份和恢复特性
- Memcached
	- 使用多节点进行数据分区 (碎片化)
	- 没有高可用性、没有复制
	- 没有备份和恢复


## 缓存策略

- Lasy Loading 懒加载
	- 命中缓存，返回
	- 未命中缓存，请求 RDS，再写入缓存
	- 增加延迟
- Write Through 穿透写入
	- 在更新数据库时添加或更新该高速缓存

## 缓存清除 和 TTL

- 缓存收回和生存时间

# Memory DB for Redis 

- 在Redis上使用MemoryDB，
	- 您将获得超快的内存速度
	- 以及跨多个AZ存储的Multi-AZ事务日志
	- 并在需要时提供快速恢复和数据持久性


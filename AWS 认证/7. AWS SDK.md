
# AWS Limit

- API 调用频率限制
	- DescribeInstances 描述实例： 每秒 100次
	- S3：GetObject 每秒每个前缀5 500次
- 服务限额
	- 一台按需标准实例：最多 1152 个 CPU
	- 可以增加服务配额

## Exponential Backoff  指数回退

指数回退就是出现错误时，重试次数越多，等待时间越长，指数级增长

- 超出  AWS 限制时，请求会返回错误，此时需要进行指数回退
- 会得到一个 ThrottlingException 
- AWS SDK 中已包含重试机制，无需在进行指数回退
- AWS API  需要自行负责回退
	- HTTP 请求返回 5xx 错误时


# AWS 证书提供链

- 使用CLI时, 它将按以下顺序查找凭据

1. 查询命令中的选项：如果在命令行选项中指定了区域､输出､配置文件或指定了额外密钥ID､ 秘密访问密钥和会话令牌, 则此选项的优先级高于任何选项
2. 环境变量
3. CLI 凭证文件
4. 容器凭证
5. 实例配置文件

## AWS SDK 默认证书提供链

- Java SDK 
1. Java 系统变量
2. 环境变量
3. 默认凭证配置文件：~/.aws/credentials
4. 容器凭证
5. 实例配置文件


## AWS  凭证的最佳实践

- 永远不要将凭据存储在代码中
- 从凭据链继承凭据
- 应尽可能多地使用IAM角色
- AWS之外工作，请使用环境变量或命名配置文件,

#  AWS API 请求

- 使用 access key 和 secret key 对请求进行签名
- S3 的一些请求不要签名，比如读取公共对象
- SDK 、CLI 大部分情况下会进行自动签名
- 使用 SignV4 进行签名

## SignV4 签名

- 通过两种方式计算签名
	- 在 HTTP 请求头中加入签名
	- 在 url 拼接参数




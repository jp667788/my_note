# ELB - Elastic Load Balance 弹性负载均衡器

## 为什么需要负载均衡

- 分散多个下游实例
- 对外只提供一个访问点
- 具有一些运行状况检查机制, 并且可以了解哪些实例不能向其发送流量，可以无缝地处理下游实例的故障
- 可以对实例进行运行状况检查
- 可作为 SSL 终端使用
- 可以通过Cookie强制实现粘性､ 跨区域的高可用性, 并将公共流量与云上的私有流量分开

- 弹性负载均衡器被 AWS 管理
- AWS负责升级､ 维护和高可用性
- 它会提供一些配置旋钮来调整负载平衡器的行为
- 集成了其他 AWS 产品

## 健康检查

- 运行状况检查是弹性负载均衡器验证EC2实例是否正常工作的一种方式，如果它工作不正常， 我们就不想向该实例发送任何流量｡
- 通过使用端口和路由来检查运行状况

## AWS 弹性负载均衡器的种类

- Classic Load Balancer 传统负载均衡器 - CLB - 2009
	- 它与HTTP､ HTTPS､ TCP､SSL或安全CP兼容
	- 已弃用
- Application Load Balancer 应用负载均衡器 - ALB -2016
	- 支持HTTP､ HTTPS和web套接字协议
- Network Load Balancer 网络负载均衡器 - NLB -2017
	- 支持TCP､ TLS､ 安全CP和UDP协议｡
- GateWay Load Balancer 网关负载均衡器 - GWLB -2020


### Application Load Balancer  应用负载均衡器 

- 基于 HTTP 协议
- 允许跨计算机路由到多个HTTP应用程序
- 延迟 400 ms
- 可以对同一EC2实例上的多个应用程序进行负载平衡
- 支持HTTP/2和WebSockets
- 支持重定向
- 支持路由表
	- 通过 URL 路由
	- 通过域名路由
	- 通过参数路由
- 非常适合微服务和基于容器的应用程序
- 具有端口映射功能，能够重定向到ECS实例上的动态端口

#### 应用负载均衡器目标组

- EC2实例
- ECS 任务
- Lamda 函数
- IP 地址 (必须是私有)

- ALB可以路由到多个目标组
- 运行状况检查将在目标组级别完成


### Network Load Balancer 网络负载均衡器

- 允许TCP和UDP流量，基于 TCP / UDP
- 性能非常高，每秒数百万请求，延迟100ms
- NLB 会给每个AZ分配一个静态IP
- 不免费

#### 网络负载均衡器的目标组

- EC2实例
- IP 地址 (必须是私有)
- 在应用程序负载平衡器之前使用网络负载平衡器
	- 借助 BLB 可以获得固定的IP地址, 而借助ALB, 您可以获得处理HTTP类型流量的所有规则
- 健康检查支持 TCP、HTTP、HTTPS


### GateWay Load Balancer 网关负载均衡器

- 可用于在AWS中部署､ 扩展和管理您的第三方网络､ 中立设备群
- 所有流量可以先进入 GWLB
- GWLB 运行于 IP 网络层

![](https://mynoteimage.oss-cn-beijing.aliyuncs.com/2023-05-12-031737.png)

#### 网关负载均衡器的目标组

- EC2实例
- IP 地址 (必须是私有)

## 跨区负载平衡

- ALB
	- 默认启用跨区
	- 不需要收费
- NLB、GWLB
	- 默认禁用跨区
	- 需要付费